<!DOCTYPE HTML>
<!--
	Editorial by HTML5 UP
	html5up.net | @ajlkn
	Free for personal and commercial use under the CCA 3.0 license (html5up.net/license)
-->
<html>
 <head>
  <title>
   Editorial by HTML5 UP
  </title>
  <meta charset="utf-8"/>
  <meta content="width=device-width, initial-scale=1, user-scalable=no" name="viewport"/>
  <link href="../assets/css/main.css" rel="stylesheet"/>
 </head>
 <body class="is-preload">
  <!-- Wrapper -->
  <div id="wrapper">
   <!-- Main -->
   <div id="main">
    <div class="inner">
     <!-- Header -->
     <header id="header">
      <a class="logo" href="../index.html">
       <strong>
        每天进步一点点
       </strong>
      </a>
      <ul class="icons">
       <li>
        <a class="icon brands fa-twitter" href="#">
         <span class="label">
          Twitter
         </span>
        </a>
       </li>
       <li>
        <a class="icon brands fa-facebook-f" href="#">
         <span class="label">
          Facebook
         </span>
        </a>
       </li>
       <li>
        <a class="icon brands fa-snapchat-ghost" href="#">
         <span class="label">
          Snapchat
         </span>
        </a>
       </li>
       <li>
        <a class="icon brands fa-instagram" href="#">
         <span class="label">
          Instagram
         </span>
        </a>
       </li>
       <li>
        <a class="icon brands fa-medium-m" href="#">
         <span class="label">
          Medium
         </span>
        </a>
       </li>
      </ul>
     </header>
     <!-- Banner -->
     <section id="banner">
      <!-- <div class="content"> -->
      <article id="article">
       <h1>
        docker使用记录
       </h1>
       <hr/>
       <h2>
        使用小贴士
       </h2>
       <ul>
        <li>
         在没有进行配置之前，使用docker必须赋予root权限
        </li>
       </ul>
       <h2>
        docker 的安装
       </h2>
       <ul>
        <li>
         <a href="https://yq.aliyun.com/articles/110806?spm=a2c4e.11153940.blogcont29941.13.520269d6XtzWqG">
          Docker CE 镜像源站
         </a>
        </li>
        <li>
         <a href="http://blog.csdn.net/qq_27818541/article/details/73647797">
          安装教程
         </a>
        </li>
        <li>
         <a href="https://cr.console.aliyun.com/?accounttraceid=3480ea01-1b31-4cb1-a169-6c220739cae6#/accelerator">
          镜像加速地址
         </a>
        </li>
        <li>
         安装过程中的依赖问题解决：sudo apt-get install -f -y
        </li>
        <li>
         <a href="https://linuxize.com/post/how-to-install-and-use-docker-on-centos-7/">
          How To Install and Use Docker on CentOS 7
         </a>
        </li>
       </ul>
       <h3>
        centos7
       </h3>
       <p>
        如果出现冲突，卸载相应冲突的软件即可
       </p>
       <p>
        <pre>bash
yum update
yum install yum-utils device-mapper-persistent-data lvm2 -y
yum-config-manager --add-repo https://download.docker.com/linux/centos/docker-ce.repo
yum install docker-ce -y
systemctl start docker
systemctl enable docker</pre>
       </p>
       <h3>
        centos8
       </h3>
       <p>
        ```sh
yum install -y yum-utils  device-mapper-persistent-data  lvm2
yum-config-manager  --add-repo   https://download.docker.com/linux/centos/docker-ce.repo
       </p>
       <h1>
        https://download.docker.com/linux/centos/7/x86_64/stable/Packages/,containerd.io-1.2.6-3.3.el7.x86_64.rpm
       </h1>
       <p>
        yum localinstall -y containerd.io-1.2.6-3.3.el7.x86_64.rpm
yum install docker-ce docker-ce-cli
       </p>
       <p>
        systemctl start docker
```
       </p>
       <h2>
        与宿主机交互类
       </h2>
       <ul>
        <li>
         单个文件挂载：将宿主的文件进行挂载时，有时docker里面对文件操作会改变宿主机，而宿主机里面操作不会改变，这个好像涉及到一些问题，不建议这样进行挂载，可以进行目录挂载
        </li>
        <li>
         目录挂载：目录挂载可以完美实现文件共享功能，docker和宿主机的操作都会改变文件（Windows里c:/xx/xx/即可）
        </li>
       </ul>
       <h3>
        Windows网络互通
       </h3>
       <p>
        ```bash
ipconfig
       </p>
       <p>
        以太网适配器 vEthernet (Default Switch):
       </p>
       <p>
        连接特定的 DNS 后缀 . . . . . . . :
   本地链接 IPv6 地址. . . . . . . . : fe80::3004:9659:3139:af85%21
   IPv4 地址 . . . . . . . . . . . . : 172.17.220.241
   子网掩码  . . . . . . . . . . . . : 255.255.255.240
   默认网关. . . . . . . . . . . . . :
       </p>
       <p>
        route add -p 172.17.0.0 mask 255.255.255.240 192.168.250.65
       </p>
       <p>
        route add -p 172.17.0.0 mask 255.255.255.240 10.0.75.2
       </p>
       <p>
        cat C:\Windows\System32\drivers\etc\hosts
       </p>
       <h1>
        Added by Docker Desktop
       </h1>
       <p>
        10.33.0.119 host.docker.internal
10.33.0.119 gateway.docker.internal
       </p>
       <h1>
        To allow the same kube context to work on the host and the container:
       </h1>
       <p>
        127.0.0.1 kubernetes.docker.internal
```
       </p>
       <h2>
        使用中需要注意的问题
       </h2>
       <ul>
        <li>
         <a href="https://yq.aliyun.com/articles/272173">
          空间的清理
         </a>
        </li>
       </ul>
       <h2>
        ssh安装
       </h2>
       <p>
        <pre>bash
yum install -y openssh-server
/usr/sbin/sshd -D</pre>
       </p>
       <h2>
        常规操作
       </h2>
       <h3>
        进入正在运行中的容器
       </h3>
       <ul>
        <li>
         docker exec -ti dockernameorid /bin/bash
        </li>
       </ul>
       <h3>
        导出镜像到本地
       </h3>
       <p>
        docker save co &gt; file
       </p>
       <h3>
        导入tar包到本地docker镜像
       </h3>
       <p>
        docker load &lt; /tmp/new-image.tar
       </p>
       <h3>
        查看ip地址
       </h3>
       <p>
        docker inspect --format='{{.NetworkSettings.IPAddress}}' mongo
       </p>
       <h3>
        映射连接问题
       </h3>
       <p>
        docker toolbox/desktop 使用上有些区别，特别是 toolbox 需要用启动时的 IP
地址不对,可能不是onlyhost模式,使用下面的地址即可
docker-machine ip default
       </p>
       <h3>
        Docker容器向宿主机传送文件
       </h3>
       <p>
        <pre>格式:
docker cp container_id:&lt;docker容器内的路径&gt; &lt;本地保存文件的路径&gt;
比如:
docker cp 10704c9eb7bb:/root/test.text /home/vagrant/test.txt</pre>
       </p>
       <h3>
        宿主机向Docker容器传送文件
       </h3>
       <p>
        ```
格式:
docker cp 本地文件的路径 container_id:
        <docker容器内的路径>
        </docker容器内的路径>
       </p>
       <p>
        比如:
docker cp  /home/vagrant/test.txt 10704c9eb7bb:/root/test.text
```
       </p>
       <h3>
        添加镜像加速器
       </h3>
       <h4>
        centos
       </h4>
       <p>
        ```bash
vim /etc/docker/daemon.json
       </p>
       <p>
        {
  "registry-mirrors": ["https://vmnyyjzt.mirror.aliyuncs.com"]
}
       </p>
       <p>
        systemctl daemon-reload
systemctl restart docker
```
       </p>
       <h4>
        windows docker toolbox
       </h4>
       <p>
        ```sh
docker-machine rm default
docker-machine create --engine-registry-mirror=https://vmnyyjzt.mirror.aliyuncs.com -d virtualbox default
docker-machine env default
eval "$(docker-machine env default)"
docker info
       </p>
       <h1>
        docker安装需要最新的boot2docker.iso，从docker的安装界面复制网址，我安装的日期是20180823，此时的boot2docker.iso地址为boot2docker.iso，这个地址貌似被墙了，需要翻墙下载，将下载好的文件放到对应文件夹下，我的电脑上为C:\Users\lzy.docker\machine\cache
       </h1>
       <p>
        ```
       </p>
       <h2>
        一些问题
       </h2>
       <h3>
        <a href="https://stackoverflow.com/questions/62441307/how-can-i-change-the-location-of-docker-images-when-using-wsl2-with-windows-10-h">
         win10 docker wsl 镜像存储位置设置
        </a>
       </h3>
       <p>
        ```bash
First, shut down your docker desktop by right click on the Docker Desktop icon and select Quit Docker Desktop
       </p>
       <p>
        Then, open your command prompt:
       </p>
       <p>
        wsl --list -v
You should be able to see, make sure the STATE for both is Stopped.
       </p>
       <p>
        NAME                   STATE           VERSION
* docker-desktop         Stopped         2
  docker-desktop-data    Stopped         2
Export docker-desktop-data into a file
       </p>
       <p>
        wsl --export docker-desktop-data "D:\Docker\wsl\data\docker-desktop-data.tar"
Unregister docker-desktop-data from wsl, note that after this, your ext4.vhdx file would automatically be removed
       </p>
       <p>
        wsl --unregister docker-desktop-data
Import the docker-desktop-data back to wsl, but now the ext4.vhdx would reside in different drive/directory:
       </p>
       <p>
        wsl --import docker-desktop-data "D:\Docker\wsl\data" "D:\Docker\wsl\data\docker-desktop-data.tar" --version 2
Start the Docker Desktop again and it should work
       </p>
       <p>
        You may delete the "D:\Docker\wsl\data\docker-desktop-data.tar" file (NOT the ext4.vhdx file) if everything looks good for you after verifying
```
       </p>
       <h3>
        重新启动镜像
       </h3>
       <p>
        docker system prune -a
       </p>
       <h2>
        常用仓库链接
       </h2>
       <ul>
        <li>
         <a href="https://hub.docker.com/_/mysql">
          mysql
         </a>
        </li>
       </ul>
       <h2>
        参考链接
       </h2>
       <ul>
        <li>
         <a href="http://www.markjour.com/article/docker-no-root.html">
          不加 sudo 执行 Docker 命令
         </a>
        </li>
        <li>
         <a href="https://dev.aliyun.com/search.html">
          阿里云docker仓库
         </a>
        </li>
        <li>
         <a href="https://my.oschina.net/editorial-story/blog/1558880">
          Docker 这九个不同的应用场景
         </a>
        </li>
        <li>
         <a href="https://zhuanlan.zhihu.com/p/38552260">
          Docker最佳实践：构建最小镜像
         </a>
        </li>
        <li>
         <a href="http://dockone.io/article/1035">
          微容器：更小的，更轻便的Docker容器
         </a>
        </li>
        <li>
         <a href="https://blog.csdn.net/gx947791229/article/details/76512660">
          docker for windows 设置aliyun加速以及改变pull镜像位置
         </a>
        </li>
       </ul>
      </article>
      <!-- </div> -->
     </section>
    </div>
   </div>
   <!-- Sidebar -->
   <div id="sidebar">
    <div class="inner">
     <!-- Menu -->
     <nav id="menu">
      <header class="major">
       <h2>
        目录
       </h2>
      </header>
      <ul>
       <li>
        <span class="opener">
         系统与软件
        </span>
        <ul>
         <li>
          <span class="opener">
           linux
          </span>
          <ul>
           <li>
            <a href="index.html">
             zsh.md
            </a>
           </li>
          </ul>
         </li>
         <li>
          <span class="opener">
           software
          </span>
          <ul>
           <li>
            <span class="opener">
             vscode
            </span>
            <ul>
             <li>
              <a href="index.html">
               vscode使用配置记录.md
              </a>
             </li>
            </ul>
           </li>
          </ul>
         </li>
         <li>
          <span class="opener">
           windows
          </span>
          <ul>
           <li>
            <a href="index.html">
             winSh中使用vim.md
            </a>
           </li>
          </ul>
         </li>
        </ul>
       </li>
       <li>
        <span class="opener">
         编程类
        </span>
        <ul>
         <li>
          <span class="opener">
           C++
          </span>
          <ul>
           <li>
            <a href="index.html">
             windows环境配置.md
            </a>
           </li>
          </ul>
         </li>
         <li>
          <span class="opener">
           git
          </span>
          <ul>
           <li>
            <a href="index.html">
             gitlab-CI.md
            </a>
           </li>
          </ul>
         </li>
         <li>
          <span class="opener">
           GoLang
          </span>
          <ul>
           <li>
            <a href="index.html">
             Go设置使用记录.md
            </a>
           </li>
          </ul>
         </li>
         <li>
          <span class="opener">
           java
          </span>
          <ul>
           <li>
            <span class="opener">
             spring
            </span>
            <ul>
             <li>
              <a href="index.html">
               SpringBoot-Mybatis-MySQL主从分离读写.md
              </a>
             </li>
            </ul>
           </li>
          </ul>
         </li>
         <li>
          <span class="opener">
           openCV
          </span>
          <ul>
           <li>
            <a href="index.html">
             轮廓检测.md
            </a>
           </li>
          </ul>
         </li>
         <li>
          <span class="opener">
           python
          </span>
          <ul>
           <li>
            <a href="index.html">
             Python3常用记录.md
            </a>
           </li>
          </ul>
         </li>
         <li>
          <span class="opener">
           SFML
          </span>
          <ul>
           <li>
            <a href="index.html">
             SFML与VS2015配置.md
            </a>
           </li>
          </ul>
         </li>
         <li>
          <span class="opener">
           人工智能
          </span>
          <ul>
           <li>
            <span class="opener">
             机器学习
            </span>
            <ul>
             <li>
              <a href="index.html">
               朴素贝叶斯分类器.md
              </a>
             </li>
            </ul>
           </li>
          </ul>
         </li>
         <li>
          <span class="opener">
           前端
          </span>
          <ul>
           <li>
            <a href="index.html">
             vue打包直接访问.md
            </a>
           </li>
          </ul>
         </li>
         <li>
          <span class="opener">
           开源
          </span>
          <ul>
           <li>
            <span class="opener">
             soul
            </span>
            <ul>
             <li>
              <a href="index.html">
               soul源码解析9-插件配置加载初探.md
              </a>
             </li>
            </ul>
           </li>
          </ul>
         </li>
        </ul>
       </li>
       <li>
        <span class="opener">
         通用类
        </span>
        <ul>
         <li>
          <a href="index.html">
           搜索技巧总结.md
          </a>
         </li>
        </ul>
       </li>
      </ul>
     </nav>
    </div>
   </div>
  </div>
  <!-- Scripts -->
  <script src="../assets/js/jquery.min.js">
  </script>
  <script src="../assets/js/browser.min.js">
  </script>
  <script src="../assets/js/breakpoints.min.js">
  </script>
  <script src="../assets/js/util.js">
  </script>
  <script src="../assets/js/main.js">
  </script>
 </body>
</html>