<!DOCTYPE HTML>
<!--
	Editorial by HTML5 UP
	html5up.net | @ajlkn
	Free for personal and commercial use under the CCA 3.0 license (html5up.net/license)
-->
<html>
 <head>
  <title>
   Editorial by HTML5 UP
  </title>
  <meta charset="utf-8"/>
  <meta content="width=device-width, initial-scale=1, user-scalable=no" name="viewport"/>
  <link href="../assets/css/main.css" rel="stylesheet"/>
 </head>
 <body class="is-preload">
  <!-- Wrapper -->
  <div id="wrapper">
   <!-- Main -->
   <div id="main">
    <div class="inner">
     <!-- Header -->
     <header id="header">
      <a class="logo" href="../index.html">
       <strong>
        每天进步一点点
       </strong>
      </a>
      <ul class="icons">
       <li>
        <a class="icon brands fa-twitter" href="#">
         <span class="label">
          Twitter
         </span>
        </a>
       </li>
       <li>
        <a class="icon brands fa-facebook-f" href="#">
         <span class="label">
          Facebook
         </span>
        </a>
       </li>
       <li>
        <a class="icon brands fa-snapchat-ghost" href="#">
         <span class="label">
          Snapchat
         </span>
        </a>
       </li>
       <li>
        <a class="icon brands fa-instagram" href="#">
         <span class="label">
          Instagram
         </span>
        </a>
       </li>
       <li>
        <a class="icon brands fa-medium-m" href="#">
         <span class="label">
          Medium
         </span>
        </a>
       </li>
      </ul>
     </header>
     <!-- Banner -->
     <section id="banner">
      <!-- <div class="content"> -->
      <article id="article">
       <h1>
        GitLab CI 部署
       </h1>
       <hr/>
       <p>
        <em>
         部署环境 Centos7
        </em>
       </p>
       <h2>
        安装
       </h2>
       <h3>
        gitlab-ci-multi-runner
       </h3>
       <p>
        <pre>sh
curl -L https://packages.gitlab.com/install/repositories/runner/gitlab-ci-multi-runner/script.rpm.sh | sudo bash
yum install gitlab-ci-multi-runner</pre>
       </p>
       <h3>
        获取项目的地址、token
       </h3>
       <ul>
        <li>
         点进项目
        </li>
        <li>
         Setting
        </li>
        <li>
         CI/CD
        </li>
        <li>
         runner
        </li>
        <li>
         Set up a specific Runner manually
        </li>
       </ul>
       <h3>
        设置项目地址、token
       </h3>
       <p>
        ```sh
gitlab-ci-multi-runner register
       </p>
       <p>
        Please enter the gitlab-ci coordinator URL: gitlab地址
Please enter the gitlab-ci token for this runner: 项目的token
Please enter the gitlab-ci description for this runner ：描述，可以进行修改
Please enter the gitlab-ci tags for this runner (comma separated): runner的标签，需要慎重填写，gitlab CI 配置文件根据标签定位runner
Whether to run untagged builds [true/false]: 询问是否在未加标签的Build上运行 true
Please enter the executor: 询问是否锁定最近项目  true
```
       </p>
       <h3>
        运行
       </h3>
       <p>
        <pre>sh
gitlab-runner restart | start | stop</pre>
       </p>
       <h2>
        项目配置
       </h2>
       <p>
        在项目根目录下新建文件：.gitlab-ci.yml（gitlab会自动识别），填入下面的内容
       </p>
       <p>
        <pre>sh
stages:
  - deploy
deploy:
  stage: deploy # 对应stages的步骤
  script: # 执行的命令
    - echo "start deploy"
    - cd /home/nssas/projects/Visual
    - mvn clean package -Dmaven.test.skip=true
    - echo "end deploy"
  only:
    - master # 设置master分支提交的时候触发
  tags:
    - master # 触发标签为master的runner</pre>
       </p>
       <h2>
        运行自动集成
       </h2>
       <p>
        <em>
         需要确保文件的权限正确，chown gitlab-runner:gitlab-runner /home/nssas/projects/Visual/target/ -R
        </em>
        代码进行提交即可进行自动集成
       </p>
       <h2>
        持续集成的步骤
       </h2>
       <ul>
        <li>
         复制主分支用于提交代码测试（CI的触发条件是提交代码，如果失败了那代码就处于异常状态，导致不能允许，当测试分支通过以后合并）
        </li>
        <li>
         检查代码格式是不是符合规范（这个怎么运行这个检查？这种应该放到本地）,Alibaba Java Coding Guidelines
        </li>
        <li>
         运行单元测试代码（测试覆盖率这个怎么搞？这种应该放到本地）
        </li>
        <li>
         运行集成测试（脚本实现？复杂的测试放到集成服务器上）
        </li>
        <li>
         <p>
          部署上线流程（DevOps？生成Docker Image，对Image进行测试？）
         </p>
        </li>
        <li>
         <p>
          如果保证测试唯一性，在测试不通过的时候不能提交代码？
         </p>
        </li>
        <li>
         GitLab有可视化的集成监视器吗？
        </li>
       </ul>
       <h2>
        参考链接
       </h2>
       <ul>
        <li>
         <a href="http://blog.sciencenet.cn/blog-350278-743765.html">
          Linux下递归改变目录及其子目录属性
         </a>
        </li>
        <li>
         <a href="https://blog.csdn.net/u011215669/article/details/80446624">
          超详细Gitlab Runner环境配置中文教程
         </a>
        </li>
        <li>
         <a href="https://juejin.im/entry/5ad8627d6fb9a045d639b043">
          利用GitLab提供的GitLab-CI以及GitLab-Runner搭建持续集成/部署环境
         </a>
        </li>
        <li>
         <a href="https://www.jianshu.com/p/2b43151fb92e">
          GitLab-CI与GitLab-Runner
         </a>
        </li>
        <li>
         <a href="https://segmentfault.com/a/1190000007180257">
          GitLab-CI 从安装到差点放弃
         </a>
        </li>
        <li>
         <a href="https://blog.csdn.net/benpaodelulu_guajian/article/details/83822059">
          Git gitlab私库clone地址
         </a>
        </li>
       </ul>
      </article>
      <!-- </div> -->
     </section>
    </div>
   </div>
   <!-- Sidebar -->
   <div id="sidebar">
    <div class="inner">
     <!-- Menu -->
     <nav id="menu">
      <header class="major">
       <h2>
        目录
       </h2>
      </header>
      <ul>
       <li>
        <span class="opener">
         系统与软件
        </span>
        <ul>
         <li>
          <span class="opener">
           linux
          </span>
          <ul>
           <li>
            <a href="index.html">
             zsh.md
            </a>
           </li>
          </ul>
         </li>
         <li>
          <span class="opener">
           software
          </span>
          <ul>
           <li>
            <span class="opener">
             vscode
            </span>
            <ul>
             <li>
              <a href="index.html">
               vscode使用配置记录.md
              </a>
             </li>
            </ul>
           </li>
          </ul>
         </li>
         <li>
          <span class="opener">
           windows
          </span>
          <ul>
           <li>
            <a href="index.html">
             winSh中使用vim.md
            </a>
           </li>
          </ul>
         </li>
        </ul>
       </li>
       <li>
        <span class="opener">
         编程类
        </span>
        <ul>
         <li>
          <span class="opener">
           C++
          </span>
          <ul>
           <li>
            <a href="index.html">
             windows环境配置.md
            </a>
           </li>
          </ul>
         </li>
         <li>
          <span class="opener">
           git
          </span>
          <ul>
           <li>
            <a href="index.html">
             gitlab-CI.md
            </a>
           </li>
          </ul>
         </li>
         <li>
          <span class="opener">
           GoLang
          </span>
          <ul>
           <li>
            <a href="index.html">
             Go设置使用记录.md
            </a>
           </li>
          </ul>
         </li>
         <li>
          <span class="opener">
           java
          </span>
          <ul>
           <li>
            <span class="opener">
             spring
            </span>
            <ul>
             <li>
              <a href="index.html">
               SpringBoot-Mybatis-MySQL主从分离读写.md
              </a>
             </li>
            </ul>
           </li>
          </ul>
         </li>
         <li>
          <span class="opener">
           openCV
          </span>
          <ul>
           <li>
            <a href="index.html">
             轮廓检测.md
            </a>
           </li>
          </ul>
         </li>
         <li>
          <span class="opener">
           python
          </span>
          <ul>
           <li>
            <a href="index.html">
             Python3常用记录.md
            </a>
           </li>
          </ul>
         </li>
         <li>
          <span class="opener">
           SFML
          </span>
          <ul>
           <li>
            <a href="index.html">
             SFML与VS2015配置.md
            </a>
           </li>
          </ul>
         </li>
         <li>
          <span class="opener">
           人工智能
          </span>
          <ul>
           <li>
            <span class="opener">
             机器学习
            </span>
            <ul>
             <li>
              <a href="index.html">
               朴素贝叶斯分类器.md
              </a>
             </li>
            </ul>
           </li>
          </ul>
         </li>
         <li>
          <span class="opener">
           前端
          </span>
          <ul>
           <li>
            <a href="index.html">
             vue打包直接访问.md
            </a>
           </li>
          </ul>
         </li>
         <li>
          <span class="opener">
           开源
          </span>
          <ul>
           <li>
            <span class="opener">
             soul
            </span>
            <ul>
             <li>
              <a href="index.html">
               soul源码解析9-插件配置加载初探.md
              </a>
             </li>
            </ul>
           </li>
          </ul>
         </li>
        </ul>
       </li>
       <li>
        <span class="opener">
         通用类
        </span>
        <ul>
         <li>
          <a href="index.html">
           搜索技巧总结.md
          </a>
         </li>
        </ul>
       </li>
      </ul>
     </nav>
    </div>
   </div>
  </div>
  <!-- Scripts -->
  <script src="../assets/js/jquery.min.js">
  </script>
  <script src="../assets/js/browser.min.js">
  </script>
  <script src="../assets/js/breakpoints.min.js">
  </script>
  <script src="../assets/js/util.js">
  </script>
  <script src="../assets/js/main.js">
  </script>
 </body>
</html>